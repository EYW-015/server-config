## Stingerhead skills
stingerhead_start_spawn:
  Skills:
    - model{mid=stingerhead;d=true} @self
    #- setAI{a=0} @self
    - effect:particles{particle=large_smoke;amount=50;hS=1;vS=1;speed=0;d=true;dir=0,1,0} @self
    - bodyclamp{m=stingerhead;c=15} @self
    - setspeed{type=walking;speed=0} @self

    - variableset{var=target.stingerhead_stinger_count;value=7;save=true}

stingerhead_finish_spawn:
  Skills:
    #- setAI{a=1} @self
    - skill{s=stingerhead_speed} @self

stingerhead_speed:
  Skills:
    - setspeed{type=walking;speed=0} @self

stingerhead_death:
  Skills:
    #- skill{s=stingerhead_detach_stinger1} @self 0.2
    #- skill{s=stingerhead_detach_stinger2} @self 0.2

stingerhead_clear_players:
  Conditions:
    - playersinradius{r=64;a>=2}
  Skills:
    - message{msg="a':' <skill.min_amount> r':' <skill.radius> d':' <skill.damage>"} @World
    - damage{a=<skill.damage>} @PIR{r=<skill.radius>}
    - throw{velocity=10;velocityY=3} @PlayersInRadius{a>=<skill.min_amount>;r=<skill.radius>}

stingerhead_leap_attack:
  Conditions:
    - playerwithin{d=12} false
    - playerwithin{d=24} true
    - targetinlineofsight{} true
  Skills:
    - state{mid=stingerhead;s=leap_attack} @self


### Stingerhead Stun States
stingerhead_stun50:
  Conditions:
    - variableisset{var=target.stun25} false
  Skills:
    - setvariable{var=target.stun25;value=1;save=true} @self
    - setAI{ai=false} @self
    - state{m=stingerhead;s=stun} @self
    - delay 30
    - setstance{stance=stun} @self

stingerhead_stun25:
  Conditions:
    - variableisset{var=target.stun25} false
  Skills:
    - setvariable{var=target.stun25;value=1;save=true} @self
    - setAI{ai=false} @self
    - state{s=stun} @self
    - setstance{s=stun} @self

stingerhead_stun_end:
  Skills:
    - setstance{s=default} @self
    - setAI{ai=true} @self

stingerhead_stun_hit:
  Conditions:
    - stance stun
  Skills:
    #- state{m=stingerhead;s=stun_hit} @self

## Stingerhead Stinger skills
stingerhead_stinger_detached_spawn:
  Skills:
    - model{mid=stingerhead_stinger;d=true} @self ~onSpawn
    - state{mid=stingerhead_stinger;s=detatching;lo=3;li=3} @self ~onSpawn

stingerhead_stinger_detached_death:
  Skills:
    - delay 20
    - effect:particles{particle=flash;amount=1;speed=0;d=true;dir=0,1,0} @self
    - delay 1
    - effect:particles{particle=dragon_breath;amount=25;hS=.5;vS=.5;speed=0;d=true;dir=0,1,0} @self
    - delay 1
    - effect:particles{particle=large_smoke;amount=50;hS=1;vS=1;speed=0;d=true;dir=0,1,0} @self

## Detached Stingers
stingerhead_detach_stinger:
  TriggerConditions:
    - (holding{m=DIAMOND_SWORD} || holding{m=NETHERITE_SWORD} || holding{m=DIAMOND_AXE} || holding{m=NETHERITE_AXE}) true
  Skills:
    - variablesubtract{var=target.stingerhead_stinger_count;amount=1}
    - submodel{mid=stingerhead;subpart=stinger<skill.stinger_part>_secondary;remove=true} @parent
    - summon{t=Stingerhead_Stinger_Detached} @self
    - throw{v=7;vy=2;delay=1} @MobsInRadius{r=5;types=Stingerhead_Stinger_Detached}


## Cancel Stinger from being damaged (does not stop basemob from being damaged)
stingerhead_cancel_stinger_damage:
  TriggerConditions:
    - (holding{m=DIAMOND_SWORD} || holding{m=NETHERITE_SWORD} || holding{m=DIAMOND_AXE} || holding{m=NETHERITE_AXE}) false
  Skills:
    - CancelEvent

stingerhead_hit_stinger:
  Skills:
    - state{mid=stingerhead;s=stinger<skill.stinger_part>_hit;i=true} @parent ~onDamaged



stingerhead_venom:
  Cooldown: 60
  Conditions:
    - incombat true
    - offgcd true
    - targetwithin{d=6} false
    - targetinlineofsight{} true
  Skills:
    - gcd{ticks=50}
    - state{s=spit} @self
    - setspeed{type=walking;speed=0} @self
    - delay 20
    - projectile{onTick=stingerhead_venom_tick;onHit=stingerhead_venom_impact;v=25;g=1;i=1;hR=1;vR=1;hnp=false;a=.6;tyo=1;syo=1.5;vn=1}
    - projectile{onTick=stingerhead_venom_tick;onHit=stingerhead_venom_impact;v=25;g=1;i=1;hR=1;vR=1;hnp=false;a=.6;tyo=1;syo=1.5;vn=1}
    - projectile{onTick=stingerhead_venom_tick;onHit=stingerhead_venom_impact;v=25;g=1;i=1;hR=1;vR=1;hnp=false;a=.6;tyo=1;syo=1.5;vn=1}
    - delay 20
    - skill{s=stingerhead_speed} @self


stingerhead_venom_tick:
  Skills:
    - effect:particles{particle=FALLING_SPORE_BLOSSOM;amount=15;hS=.25;vS=.25;speed=1.25}

stingerhead_venom_impact:
  Skills:
    - effect:particles{particle=falling_obsidian_tear;amount=2;hS=.25;vS=.5;y=.5;repeat=30;repeatInterval=2}
    - potion{type=POISON;duration=20;level=2}
    - potion{type=BLINDNESS;duration=15;level=1}

stingerhead_venom_stinger:
  - message{msg="a"} @World
  - message{msg=<caster.stingerhead_stinger_count>} @World
  - potion{type=POISON;duration=<caster.stingerhead_stinger_count>*1.5;level=<caster.stingerhead_stinger_count>-1} @trigger
